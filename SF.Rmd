---
title: "Workshop on Geodata"
output: html_document
date: "2023-10-13"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Packages 

These are all the packages we will need 

```{r cars}
# Define Berlin's coordinates
#install.packages("geosphere")
library(geosphere)
library(tmaptools)
library(nominatim)
library(sf)
library(ggmap)
library(sf)
#install.packages("mapview")
library(mapview)
#install.packages("ggmap")
library(sf)
library(tmaptools)

install.packages("dsf")

```

## Transforming point data to a sf object

We are from Rome and Tianjin. Let's see where these are on a map 

```{r pressure, echo=FALSE}
# This code finds the coordinate of Berlin 


cities <- data.frame(
  place = c("Rome", "Tianjin", "Ottawa"),
  long = c(12.496366, 117.190182, -75.690308),  
  lat = c(41.902782, 39.084158, 45.421529),    
  value = c(500, 600, 700))                     

class(cities)  # WHY DO WE CHECK CLASS

cities_dsf <- st_as_sf(cities, coords = c("long", "lat")) # st_as_sf function is used to convert data, such as a data frame or a matrix, into an sf object. An sf object is a special data structure used for working with spatial data. 
st_crs(cities_dsf) <- 4326
class(cities_dsf)

mapview(cities_dsf)

```

Quite cool! But to insert the coordinates feels a bit lenghty, especially when there is a r function that does it for you/ I am referring to geocode_OSM() 
```{r}

cities_c <- c("Rome", "Tianjin", "Ottawa")
geocoded_cities <- geocode_OSM(cities_c) 

geocoded_cities

# Create new column using st_as_sf to store the geometry in a column 

geometry_geocoded_cities <- st_as_sf(geocoded_cities,
                      coords = c(x = "lon", y = "lat"),
                      crs = 4326)

geometry_geocoded_cities
mapview(geometry_geocoded_cities)


```


calculate distance between cities 
```{r}


```


Pretty cool because when only did geocode("Rome"), you are required to use an API address, so going to google and scrape that.  Just for demostration, this is what happens.  

```{r pressure, echo=FALSE}
geocode_OSM("Rome")

```



```{r}



```

```
